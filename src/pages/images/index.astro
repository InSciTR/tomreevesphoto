---
import BaseLayout from "../../layouts/BaseLayout.astro";

/* Load every manifest once at build-time */
const modules = import.meta.glob('../../data/galleries/*.json', { eager: true });
const sets = Object.values(modules).map((m) => m.default);

sets.sort((a, b) => a.title.localeCompare(b.title));
---

<BaseLayout title="Images">
  <section class="max-w-5xl mx-auto px-6 py-16">
    <h1 class="text-4xl font-bold mb-8">Image Sets</h1>

    <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
      {sets.map((set) => (
        <a href={`/images/${set.slug}/`} class="group block">
          {set.cover && (
            <img
              src={set.cover.replace('~', '')}
              alt={set.title}
              class="rounded w-full h-auto mb-2 transition group-hover:opacity-80"
              loading="lazy"
            />
          )}
          <h2 class="text-lg font-semibold capitalize">{set.title}</h2>
        </a>
      ))}
    </div>
  </section>
</BaseLayout>